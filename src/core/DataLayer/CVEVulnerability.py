# ---------------------------------------------------------------------------------------------------------------------
# Finding.py
#
# Author      : Peter Heijligers
# Description : Validation functions
#
# Date       Ini Description
# ---------- --- ------------------------------------------------------------------------------------------------------
# 2018-10-22 PHe First creation
# ---------------------------------------------------------------------------------------------------------------------
from src.gl.Const import EMPTY


def get_sophisticated_version(version) -> str:
    """
    Example: Elastic search 1.2.3-20.1.
    This refers to Elastic search 1.2.3, Siren 20.1, so only the 1st part is interesting.
    """
    if not version:
        return EMPTY
    p = version.find('-')
    return version[:p] if p > -1 else version


class CVEVulnerability(object):

    @property
    def CVE_id(self):
        return self._cve_id

    @property
    def CVE_published(self):
        return self._cve_published

    @property
    def CVE_last_modified(self):
        return self._cve_last_modified

    @property
    def severity(self):
        return self._severity

    @property
    def criteria(self):
        return self._criteria

    @property
    def version_start_including(self):
        return self._version_start_including

    @property
    def version_end_excluding(self):
        return self._version_end_excluding

    @property
    def version_end_including(self):
        return self._version_end_including

    @property
    def description(self):
        return self._description

    def __init__(self,
                 cve_id=EMPTY,
                 cve_published=EMPTY,
                 cve_last_modified=EMPTY,
                 severity=EMPTY,
                 criteria=EMPTY,
                 version_start_including=EMPTY,
                 version_end_excluding=EMPTY,
                 version_end_including=EMPTY,
                 description=EMPTY,
                 ):
        self._cve_id = cve_id
        self._cve_published = cve_published
        self._cve_last_modified = cve_last_modified
        self._severity = severity
        self._criteria = criteria
        self._version_start_including = get_sophisticated_version(version_start_including)
        self._version_end_excluding = get_sophisticated_version(version_end_excluding)
        self._version_end_including = get_sophisticated_version(version_end_including)
        self._description = description
